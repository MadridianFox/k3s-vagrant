# K3S on vagrant with virtualbox driver #

Этот репозиторий содержит всё необходимое для того чтобы получить вирутальную машину с установленным в ней  k3s - облегчённой версией k8s.

## Установка ##

Зависимости:

- virtualbox
- vagrant
- kubectl

После клонирования репозитория заходим в папку и выпоняем:
```
vagrant up
```

Это создат виртуальную машину с именем `k3s`.
Машина пробрасывает порт 6443 на localhost для подключения через kubectl.

## Подключение ##
Для получения конфига подключения к `k3s` выполните команду:
```
ssh vagrant@localhost -p 2222 'sudo k3s kubectl config view'
```
В ответ будет напечатан конфиг подключения который вы можете положить (или руками интегрировать, если файл уже есть) в файл `~/.kube/config`.
Т.к. мы работает локально, то строчку
```
certificate-authority-data: DATA+OMITTED
```
можно заменить на
```
insecure-skip-tls-verify: true
```
Или вы можете зайти в виртуальную машину и увидеть полный конфиг (вместе с сертификатом) в файле `/etc/rancher/k3s/k3s.yaml`
